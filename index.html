<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0A84FF" />
  <title>AutoFlow · Bots, scrapers et automatisations sur mesure</title>

  <!-- Meta / Open Graph -->
  <meta name="description" content="Nous concevons des bots, scrapers et automatisations qui travaillent pour vous. Parlez-nous de votre projet, on s'occupe du reste." />
  <meta property="og:title" content="AutoFlow · Bots, scrapers et automatisations" />
  <meta property="og:description" content="Parlez-nous de votre projet, on s'occupe du reste." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://images.pexels.com/photos/2058128/pexels-photo-2058128.jpeg?auto=compress&cs=tinysrgb&w=1200" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Favicon (SVG data URL) -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop stop-color="%230A84FF"/><stop offset="1" stop-color="%23A8C7FF"/></linearGradient></defs><rect width="64" height="64" rx="14" fill="url(%23g)"/><path d="M34 6 14 33h12l-2 25 20-27H32l2-25z" fill="white"/></svg>'>

  <!-- Fonts (performantes) -->
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@600;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Perf pré-connexions (images + vidéos placeholders) -->
  <link rel="preconnect" href="https://images.pexels.com" crossorigin>
  <link rel="preconnect" href="https://commondatastorage.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://samplelib.com" crossorigin>

  <style>
    :root{
      /* Couleurs */
      --bg:#0b0e14; --bg-soft:#0e121a; --elev:#111725;
      --text:#f3f6ff; --muted:#a9b4c6; --hair:rgba(255,255,255,.10);
      --accent:#0A84FF; --accent-2:#66A8FF;
      --grad: linear-gradient(135deg, var(--accent), var(--accent-2));

      /* Rythme */
      --r:20px; --gap:clamp(14px,3vw,22px);

      /* Ombres premium */
      --shadow-1: 0 8px 22px rgba(0,0,0,.28);
      --shadow-2: 0 16px 36px rgba(0,0,0,.40);
      --shadow-3: 0 24px 60px rgba(0,0,0,.55);
    }
    *,*::before,*::after{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;background:var(--bg);color:var(--text);font:400 16px/1.6 Inter,system-ui,sans-serif;overflow-x:hidden}
    img,video{display:block;max-width:100%}
    a{color:inherit;text-decoration:none}
    section{padding:90px 0;scroll-margin-top:84px}
    .container{max-width:1120px;margin:0 auto;padding:0 var(--gap)}
    .title{font:800 clamp(28px,5vw,48px)/1.1 Manrope,Inter,sans-serif;letter-spacing:.2px;margin:0 0 10px}
    .sub{color:var(--muted);max-width:720px;margin:0 auto}

    /* Header */
    .site-header{position:sticky;top:0;z-index:50;background:linear-gradient(180deg, rgba(11,14,20,.85), rgba(11,14,20,.55));backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.06)}
    .nav{display:flex;align-items:center;justify-content:space-between;height:72px}
    .brand{display:flex;align-items:center;gap:12px}
    .badge{width:40px;height:40px;border-radius:12px;background:var(--grad);display:grid;place-items:center;box-shadow:0 6px 18px rgba(10,132,255,.35)}
    .brand span{font:800 20px/1 Manrope}
    .navlinks{display:flex;gap:18px;align-items:center}
    .link{position:relative;padding:8px 10px;border-radius:10px;color:#dfe7f6}
    .link::after{content:"";position:absolute;left:10px;right:10px;bottom:6px;height:2px;border-radius:2px;background:var(--grad);transform:scaleX(0);transition:transform .22s}
    .link:hover::after,.link[aria-current="page"]::after{transform:scaleX(1)}
    .pill{padding:9px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06)}

    /* Hero */
    .hero{position:relative;min-height:86vh;display:grid;place-items:center;overflow:hidden}
    .hero-media{position:absolute;inset:0;z-index:-2}
    .hero-media img{width:100%;height:100%;object-fit:cover;filter:contrast(1.08) saturate(1.03)}
    .hero::after{content:"";position:absolute;inset:0;background:
      linear-gradient(180deg, rgba(7,10,16,.15) 0%, rgba(7,10,16,.50) 50%, rgba(7,10,16,.86) 100%);
      z-index:-1}
    .hero h1{font:800 clamp(34px,6vw,62px)/1.05 Manrope;margin:0 0 10px;text-align:center}
    .hero p{color:#d6deee;text-align:center;max-width:780px;margin:0 auto 24px}
    .actions{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:10px;border:none;border-radius:14px;padding:14px 18px;font-weight:700;cursor:pointer;transition:transform .12s, box-shadow .12s, background .2s}
    .btn svg{flex:0 0 auto}
    .btn-primary{background:var(--grad);color:#fff;box-shadow:var(--shadow-1)}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:var(--shadow-2)}
    .btn-ghost{background:rgba(255,255,255,.08);color:#eef3ff;border:1px solid var(--hair)}
    .btn-ghost:hover{transform:translateY(-1px)}
    .btn-quiet{background:rgba(255,255,255,.06);border:1px solid var(--hair);color:#fff}

    /* Projects */
    .projects{background:var(--bg-soft)}
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:22px}
    .card{position:relative;border-radius:22px;overflow:hidden;background:#0f141d;border:1px solid var(--hair);box-shadow:var(--shadow-1);transition:transform .2s, box-shadow .25s}
    .card:focus-visible{outline:2px solid var(--accent)}
    .card:hover{transform:translateY(-2px);box-shadow:var(--shadow-2)}
    .thumb{aspect-ratio:16/10;overflow:hidden;position:relative}
    .thumb img{width:100%;height:100%;object-fit:cover;transform:scale(1.03);transition:transform .45s}
    .card:hover .thumb img{transform:scale(1.07)}
    .thumb::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0) 50%, rgba(0,0,0,.78) 100%)}
    .card-body{position:absolute;left:18px;right:18px;bottom:18px;z-index:2;color:#fff;text-shadow:0 2px 18px rgba(0,0,0,.55)}
    .card h3{margin:0 0 6px;font:800 20px/1.25 Manrope}
    .card p{margin:0;color:#e8eefc;opacity:.95}
    .chip{position:absolute;top:12px;right:12px;background:rgba(0,0,0,.50);border:1px solid rgba(255,255,255,.28);color:#fff;padding:6px 10px;border-radius:999px;font-weight:700}

    /* Expertise (plus léger) */
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:22px}
    .exp{background:linear-gradient(180deg,#111826,#0f1520);border:1px solid var(--hair);border-radius:22px;padding:20px;box-shadow:var(--shadow-1)}
    .exp-head{display:flex;align-items:center;gap:10px;margin-bottom:6px}
    .exp-icon{width:34px;height:34px;border-radius:12px;border:1px solid var(--hair);background:rgba(255,255,255,.06);display:grid;place-items:center}
    .exp h4{margin:0;font:800 18px/1.3 Manrope}
    .exp p{margin:6px 0 10px;color:#c7d1e3}
    .exp ul{margin:0;padding:0 0 0 18px;color:#c7d1e3}
    .more{margin-top:10px}
    .more summary{cursor:pointer;color:#cfe0ff}
    .more p{margin:8px 0 0}

    /* FAQ */
    .faq .items{max-width:880px;margin:0 auto}
    details{background:#101623;border:1px solid var(--hair);border-radius:18px;padding:14px 18px;box-shadow:var(--shadow-1);margin-bottom:12px}
    summary{cursor:pointer;font:800 18px/1.3 Manrope;list-style:none;display:flex;align-items:center;gap:10px}
    summary::-webkit-details-marker{display:none}
    .answer{color:#cbd6e6;margin:8px 4px 4px}

    /* Contact */
    .contact .form{max-width:980px;margin:0 auto;background:#0f141d;border:1px solid var(--hair);border-radius:26px;padding:22px;box-shadow:var(--shadow-2)}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .field{display:flex;flex-direction:column;gap:8px;position:relative}
    .field label{font-weight:700}
    .input, textarea, select{width:100%;background:#0a0f16;color:#eef3ff;border:1px solid #1b2737;border-radius:14px;padding:14px 14px 14px 44px;font:500 16px/1.5 Inter}
    .input::placeholder, textarea::placeholder{color:#74829b}
    .input:focus, textarea:focus, select:focus{outline:2px solid var(--accent);box-shadow:0 0 0 6px rgba(10,132,255,.15)}
    .adorn{position:absolute;left:12px;top:42px;opacity:.75}
    .full{grid-column:1/-1}
    .form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
    .status{margin-top:10px;color:#9fe3b2;display:none}
    .status.error{color:#ff9f9f}

    /* Modal (dialog) */
    dialog#projectModal{border:1px solid var(--hair);border-radius:18px;padding:0;max-width:980px;width:calc(100% - 24px);background:#0f141d;color:var(--text);box-shadow:var(--shadow-3)}
    .m-head{display:flex;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px solid var(--hair)}
    .m-title{font:800 18px/1.2 Manrope}
    .m-actions{margin-left:auto;display:flex;gap:6px}
    .iconbtn{width:36px;height:36px;border-radius:999px;border:1px solid var(--hair);background:rgba(255,255,255,.06);color:#fff}
    .m-body{padding:14px;max-height:70vh;overflow:auto}
    .m-video{width:100%;max-height:50vh;object-fit:cover;border-radius:12px}
    .stack{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}
    .tag{padding:6px 10px;border:1px solid var(--hair);border-radius:999px;background:rgba(255,255,255,.06)}
    .m-cta{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}

    /* Footer */
    footer{background:#0a0f16;border-top:1px solid var(--hair);padding:38px 0;color:#c6d0df}
    .foot{display:grid;grid-template-columns:repeat(4,1fr);gap:22px}
    .foot h5{margin:0 0 8px;font:800 16px/1.3 Manrope;color:#dfe7f6}
    .foot small{grid-column:1/-1;opacity:.7;margin-top:16px;display:block;text-align:center}

    /* Responsive */
    @media (max-width:1024px){
      .cards{grid-template-columns:repeat(2,1fr)}
      .grid3{grid-template-columns:repeat(2,1fr)}
    }
    @media (max-width:740px){
      section{padding:68px 0}
      .cards,.grid3,.grid2{grid-template-columns:1fr}
    }

    /* Accessibilité visuelle & scrollbars */
    a:focus-visible,button:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:10px}
    *::-webkit-scrollbar{height:12px;width:12px}
    *::-webkit-scrollbar-thumb{background:rgba(255,255,255,.10);border:3px solid transparent;border-radius:20px;background-clip:padding-box}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="#accueil">
        <span class="badge" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="white" aria-hidden="true"><path d="M13.5 2 5 13h6l-1 9 8.5-11h-6L13.5 2z"/></svg>
        </span>
        <span>AutoFlow</span>
      </a>
      <nav class="navlinks" aria-label="Navigation principale">
        <a class="link" href="#accueil">Accueil</a>
        <a class="link" href="#projets">Projets</a>
        <a class="link" href="#expertise">Expertise</a>
        <a class="link" href="#faq">FAQ</a>
        <a class="link pill" href="#contact">Parler à un humain</a>
      </nav>
    </div>
  </header>

  <main id="accueil" class="hero">
    <div class="hero-media">
      <img src="https://images.pexels.com/photos/2058128/pexels-photo-2058128.jpeg?auto=compress&cs=tinysrgb&w=1920&h=1080" alt="">
    </div>
    <div class="container">
      <h1>Tout devient automatique, sauf vos idées</h1>
      <p>Nous créons des bots, scrapers et automatisations sur mesure qui travaillent pour vous. Parlez-nous de votre cas, on revient avec un plan simple et un premier pas concret.</p>
      <div class="actions">
        <a class="btn btn-primary" href="#contact">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M13 2 3 14h7l-1 8 10-12h-7l1-8z"/></svg>
          Parler de mon projet
        </a>
        <a class="btn btn-ghost" href="#projets">Voir des exemples</a>
      </div>
    </div>
  </main>

  <!-- Projects -->
  <section id="projets" class="projects">
    <div class="container">
      <h2 class="title" style="text-align:center">Exemples de réalisations</h2>
      <p class="sub" style="text-align:center">Démos internes prêtes à adapter à votre contexte.</p>

      <div id="cards" class="cards" aria-live="polite"></div>
    </div>
  </section>

  <!-- Expertise -->
  <section id="expertise">
    <div class="container">
      <h2 class="title" style="text-align:center">Ce que nous savons faire</h2>
      <p class="sub" style="text-align:center">Des briques techniques fiables, assemblées sur mesure.</p>

      <div class="grid3" style="margin-top:24px">
        <div class="exp">
          <div class="exp-head">
            <div class="exp-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="#dfe7f6"><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></svg></div>
            <h4>Web scraping</h4>
          </div>
          <p>Surveillez le marché sans effort. Le bot collecte, nettoie et vous montre ce qui compte.</p>
          <ul>
            <li>Collecte multi-sites avec supervision</li>
            <li>Tableaux de bord, alertes et exports simples</li>
          </ul>
          <details class="more"><summary>Voir plus</summary>
            <p>Anti-blocage, planification, normalisation des données, filtres avancés et exports JSON, CSV ou base de données.</p>
          </details>
        </div>

        <div class="exp">
          <div class="exp-head">
            <div class="exp-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="#dfe7f6"><path d="M12 2a5 5 0 0 0-5 5v3H5a2 2 0 0 0-2 2v7h18v-7a2 2 0 0 0-2-2h-2V7a5 5 0 0 0-5-5z"/></svg></div>
            <h4>Bots et agents</h4>
          </div>
          <p>Chatbots, modération, assistants qui répondent et exécutent vos workflows.</p>
          <ul>
            <li>DM ciblés, commandes, suivi et statistiques</li>
            <li>Anti-spam, quotas, hébergement chez vous ou géré</li>
          </ul>
          <details class="more"><summary>Voir plus</summary>
            <p>Telegram, WhatsApp, Slack ou web. Journalisation, alertes, supervision, règles métier et escalade humaine.</p>
          </details>
        </div>

        <div class="exp">
          <div class="exp-head">
            <div class="exp-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="#dfe7f6"><path d="M12 2a7 7 0 0 0-7 7c0 5 7 13 7 13s7-8 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5z"/></svg></div>
            <h4>Applications IA</h4>
          </div>
          <p>Résumé, classement, extraction d’entités ou assistant RAG sur vos documents.</p>
          <ul>
            <li>Déploiement sur votre cloud ou le nôtre</li>
            <li>Prompts testés et mesurés</li>
          </ul>
          <details class="more"><summary>Voir plus</summary>
            <p>API, connecteurs, ingestion documentaire, évaluation, boucles de feedback et gouvernance des accès.</p>
          </details>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="faq">
    <div class="container">
      <h2 class="title" style="text-align:center">FAQ</h2>
      <div class="items">
        <details open><summary>Combien de temps pour un projet type ?</summary>
          <div class="answer">La plupart des projets se livrent en 5 à 15 jours ouvrés.</div>
        </details>
        <details><summary>Qui gère l’hébergement ?</summary>
          <div class="answer">Au choix. Nous déployons dans votre environnement ou nous opérons pour vous.</div>
        </details>
        <details><summary>Et si j’ai besoin d’aide après ?</summary>
          <div class="answer">Support humain sur demande, petites évolutions et monitoring.</div>
        </details>
        <details><summary>Combien ça coûte ?</summary>
          <div class="answer">On propose un cadrage simple, puis un budget fixe ou au temps passé selon le cas.</div>
        </details>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="contact">
    <div class="container">
      <h2 class="title" style="text-align:center">Parlez-nous de votre projet</h2>
      <p class="sub" style="text-align:center">Dites ce que vous voulez automatiser. On répond avec un plan d’action (souvent le jour même) et on cale un appel si besoin.</p>

      <form id="leadForm" class="form" action="https://formspree.io/f/xblkpvaz" method="POST" novalidate>
        <!-- honeypot -->
        <input type="text" name="website" tabindex="-1" aria-hidden="true" style="position:absolute;left:-9999px">

        <div class="grid2">
          <div class="field">
            <label for="name">Prénom</label>
            <span class="adorn"><svg width="18" height="18" fill="#8ea2bd" viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.33 0-8 2.17-8 5v1h16v-1c0-2.83-3.67-5-8-5Z"/></svg></span>
            <input id="name" name="name" class="input" placeholder="Votre prénom" required>
          </div>
          <div class="field">
            <label for="email">Email</label>
            <span class="adorn"><svg width="18" height="18" fill="#8ea2bd" viewBox="0 0 24 24"><path d="M4 4h16v16H4V4Zm8 7L4 6v12l8-7 8 7V6l-8 5Z"/></svg></span>
            <input id="email" name="email" class="input" type="email" inputmode="email" autocomplete="email" required placeholder="vous@exemple.com">
          </div>
          <div class="field">
            <label for="phone">Téléphone (optionnel)</label>
            <span class="adorn"><svg width="18" height="18" fill="#8ea2bd" viewBox="0 0 24 24"><path d="M6.6 10.8a15 15 0 0 0 6.6 6.6l2.2-2.2a1 1 0 0 1 1-.24c1.1.37 2.3.57 3.6.57a1 1 0 0 1 1 1V21a1 1 0 0 1-1 1A19 19 0 0 1 3 7a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1 1c0 1.28.2 2.5.57 3.6a1 1 0 0 1-.24 1l-2.23 2.2z"/></svg></span>
            <input id="phone" name="phone" class="input" type="tel" inputmode="tel" pattern="[\d\s()+\-\.]{7,}" placeholder="+33 X XX XX XX XX">
          </div>
          <div class="field">
            <label for="pref">Comment préférez-vous échanger ?</label>
            <span class="adorn"><svg width="18" height="18" fill="#8ea2bd" viewBox="0 0 24 24"><path d="M4 5h16v2H4V5zm0 6h16v2H4v-2zm0 6h16v2H4v-2z"/></svg></span>
            <select id="pref" name="preference" class="input">
              <option>Appel visio 30 min</option>
              <option>Email</option>
              <option>WhatsApp</option>
            </select>
          </div>
          <div class="field full">
            <label for="msg">Que voulez-vous automatiser ?</label>
            <span class="adorn" style="top:46px"><svg width="18" height="18" fill="#8ea2bd" viewBox="0 0 24 24"><path d="M3 4h18v2H3V4zm0 6h12v2H3v-2zm0 6h18v2H3v-2z"/></svg></span>
            <textarea id="msg" name="message" rows="5" placeholder="Ex : surveiller des annonces et envoyer des alertes Telegram ; bot qui répond aux messages et redirige vers mon canal ; tableau de bord ventes..."></textarea>
          </div>
          <input type="hidden" name="project" id="projectField" />
        </div>

        <div class="form-actions">
          <button type="button" id="btnMailTo" class="btn btn-quiet">Planifier par email</button>
          <button class="btn btn-primary" type="submit">Envoyer ma demande (réponse &lt; 24 h)</button>
        </div>
        <p class="status" role="status" aria-live="polite">Merci ! Nous revenons vers vous sous 24 h.</p>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container foot">
      <div>
        <h5>AutoFlow</h5>
        <p>Automatisations invisibles qui libèrent votre temps et amplifient vos résultats.</p>
      </div>
      <div>
        <h5>Services</h5>
        <ul>
          <li>Web scraping</li>
          <li>Bots et agents</li>
          <li>Applications IA</li>
          <li>Solutions sur mesure</li>
        </ul>
      </div>
      <div>
        <h5>Entreprise</h5>
        <ul>
          <li><a href="#projets">Nos réalisations</a></li>
          <li><a href="#faq">FAQ</a></li>
        </ul>
      </div>
      <div>
        <h5>Contact</h5>
        <ul>
          <li>Email : hello@autoflow.fr</li>
          <li>Téléphone : +33 1 23 45 67 89</li>
          <li>LinkedIn : /company/autoflow</li>
        </ul>
      </div>
      <small>© 2025 AutoFlow. Tous droits réservés.</small>
    </div>
  </footer>

  <!-- Modal dialog (projet) -->
  <dialog id="projectModal" aria-labelledby="modalTitle">
    <div class="m-head">
      <div id="modalTitle" class="m-title">Projet</div>
      <div class="m-actions">
        <button class="iconbtn" id="prevBtn" aria-label="Précédent">‹</button>
        <button class="iconbtn" id="nextBtn" aria-label="Suivant">›</button>
        <button class="iconbtn" id="closeBtn" aria-label="Fermer">✕</button>
      </div>
    </div>
    <div class="m-body">
      <video id="mVideo" class="m-video" controls playsinline preload="metadata" poster="">
        <source id="mSrc" src="" type="video/mp4">
      </video>
      <p id="mDesc" style="margin:12px 0 6px"></p>
      <div id="mStack" class="stack"></div>
      <h4 style="margin:10px 0 6px;font:800 16px/1.3 Manrope">Fonctionnalités clés</h4>
      <ul id="mPoints" style="margin-left:18px;display:grid;gap:6px"></ul>
      <div class="m-cta">
        <button class="btn btn-quiet" id="ctaDiscuss">Discuter de ce projet</button>
        <button class="btn btn-primary" id="ctaAdapt">Adapter à mon cas</button>
      </div>
    </div>
  </dialog>

  <script>
    // Liens actifs au scroll
    const navLinks = [...document.querySelectorAll('.navlinks .link')];
    const watch = navLinks.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);
    if('IntersectionObserver' in window){
      const io = new IntersectionObserver(entries=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            navLinks.forEach(x=>x.removeAttribute('aria-current'));
            const l = navLinks.find(x => x.getAttribute('href') === '#' + e.target.id);
            l?.setAttribute('aria-current','page');
          }
        });
      }, {threshold:.6, rootMargin:"-70px 0px -40% 0px"});
      watch.forEach(s=>io.observe(s));
    }

    // Charger projets depuis projects.json
    const cardsEl = document.getElementById('cards');
    let PROJECTS = [], current = 0;

    fetch('projects.json', {cache:'no-store'})
      .then(r=>r.json())
      .then(list=>{
        PROJECTS = list;
        renderCards(list);
      })
      .catch(()=>{ cardsEl.innerHTML = '<p style="color:#ffd7d7">Impossible de charger les projets.</p>'; });

    function renderCards(list){
      cardsEl.innerHTML = list.map((p,idx)=>`
        <article class="card" data-idx="${idx}" tabindex="0" role="button" aria-label="Détails du projet: ${p.title}">
          <div class="chip">Détails</div>
          <div class="thumb">
            <img src="${p.thumb}" alt="">
          </div>
          <div class="card-body">
            <h3>${p.title}</h3>
            <p>${p.subtitle}</p>
          </div>
        </article>
      `).join('');
      cardsEl.querySelectorAll('.card').forEach(card=>{
        card.addEventListener('click', onOpen);
        card.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); onOpen.call(card,e); }});
      });
    }

    // Modal logic (accessible dialog)
    const dlg = document.getElementById('projectModal');
    const mTitle = document.getElementById('modalTitle');
    const mVideo = document.getElementById('mVideo');
    const mSrc = document.getElementById('mSrc');
    const mDesc = document.getElementById('mDesc');
    const mStack = document.getElementById('mStack');
    const mPoints = document.getElementById('mPoints');
    const btnPrev = document.getElementById('prevBtn');
    const btnNext = document.getElementById('nextBtn');
    const btnClose = document.getElementById('closeBtn');
    const ctaDiscuss = document.getElementById('ctaDiscuss');
    const ctaAdapt = document.getElementById('ctaAdapt');
    let lastFocus = null;

    function renderModal(i){
      const p = PROJECTS[i];
      if(!p) return;
      mTitle.textContent = p.title;
      mSrc.src = p.video;
      mVideo.poster = p.poster || p.thumb;
      mVideo.load();
      mDesc.textContent = p.desc;
      mStack.innerHTML = p.stack.map(s=>`<span class="tag">${s}</span>`).join('');
      mPoints.innerHTML = p.points.map(pt=>`<li>${pt}</li>`).join('');
      // Préremplissage CTA
      ctaDiscuss.onclick = ()=> fillAndGo(p, 'Je veux discuter de ce projet');
      ctaAdapt.onclick = ()=> fillAndGo(p, 'J’aimerais adapter ce projet à mon cas');
    }

    function onOpen(e){
      current = +this.dataset.idx;
      renderModal(current);
      lastFocus = document.activeElement;
      if(typeof dlg.showModal === 'function'){ dlg.showModal(); } else { dlg.setAttribute('open',''); }
      document.documentElement.style.overflow = 'hidden';
    }
    function onClose(){
      dlg.close();
      document.documentElement.style.overflow = '';
      lastFocus?.focus();
      mVideo.pause();
    }
    btnPrev.addEventListener('click', ()=>{ current = (current-1+PROJECTS.length)%PROJECTS.length; renderModal(current); });
    btnNext.addEventListener('click', ()=>{ current = (current+1)%PROJECTS.length; renderModal(current); });
    btnClose.addEventListener('click', onClose);
    dlg.addEventListener('click', e=>{ if(e.target === dlg) onClose(); });
    document.addEventListener('keydown', e=>{
      if(!dlg.open) return;
      if(e.key === 'Escape') onClose();
      if(e.key === 'ArrowRight') btnNext.click();
      if(e.key === 'ArrowLeft') btnPrev.click();
    });

    // CTA -> contact + préremplissage
    function fillAndGo(p, lead){
      const field = document.getElementById('projectField');
      const msg = document.getElementById('msg');
      field.value = p.title;
      const line = `Projet choisi: ${p.title}. ${lead}.`;
      msg.value = msg.value ? `${msg.value}\n\n${line}` : line;
      onClose();
      document.querySelector('#contact').scrollIntoView({behavior:'smooth', block:'start'});
      setTimeout(()=> document.getElementById('name').focus(), 400);
    }

    // Form validation + submit async Formspree
    const form = document.getElementById('leadForm');
    const status = form.querySelector('.status');
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      status.classList.remove('error');
      status.textContent = 'Envoi en cours...';
      status.style.display = 'block';

      const name = form.name.value.trim();
      const email = form.email.value.trim();
      if(!name || !email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
        status.textContent = 'Merci de vérifier votre prénom et votre email.';
        status.classList.add('error');
        return;
      }
      if(form.website.value){ status.textContent = 'OK.'; return; } // honeypot

      try{
        const res = await fetch(form.action, { method:"POST", headers:{Accept:"application/json"}, body:new FormData(form) });
        if(res.ok){
          form.reset();
          status.classList.remove('error');
          status.textContent = 'Merci ! Nous vous répondons sous 24 h.';
          setTimeout(()=> status.style.display='none', 4500);
        }else{
          throw new Error();
        }
      }catch{
        status.textContent = 'Erreur côté réseau. Merci de réessayer.';
        status.classList.add('error');
      }
    });

    // “Planifier par email” — ouvre un mailto prérempli
    document.getElementById('btnMailTo').addEventListener('click', ()=>{
      const subject = encodeURIComponent('AutoFlow · Projet à automatiser');
      const body = encodeURIComponent(
        `Bonjour,\n\nVoici mon besoin:\n${document.getElementById('msg').value || ''}\n\nPrénom: ${document.getElementById('name').value || ''}\nTéléphone: ${document.getElementById('phone').value || ''}\nPréférence: ${document.getElementById('pref').value}\n`
      );
      window.location.href = `mailto:hello@autoflow.fr?subject=${subject}&body=${body}`;
    });
  </script>
</body>
</html>
